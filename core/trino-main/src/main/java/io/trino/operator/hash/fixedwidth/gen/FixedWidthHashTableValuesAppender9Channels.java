/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package io.trino.operator.hash.fixedwidth.gen;

import io.trino.operator.hash.AbstractHashTableValuesAppender;
import io.trino.operator.hash.ColumnValueExtractor;
import io.trino.operator.hash.HashTableData;
import io.trino.operator.hash.fastbb.FastByteBuffer;
import io.trino.operator.hash.fixedwidth.FixedWidthEntryStructure;
import io.trino.operator.hash.fixedwidth.FixedWidthGroupByHashTableEntries;
import io.trino.spi.PageBuilder;
import io.trino.spi.block.BlockBuilder;

import static com.google.common.base.Preconditions.checkArgument;
import static io.trino.spi.type.BigintType.BIGINT;
import static java.util.Objects.requireNonNull;

/**
 * This class has been generated by the FixedWidthHashTableValuesAppenderGenerator class.
 * The generation is a one-time event and is not repeated during build
 */
public final class FixedWidthHashTableValuesAppender9Channels
        extends AbstractHashTableValuesAppender
{
    private final ColumnValueExtractor columnValueExtractor0;

    private final ColumnValueExtractor columnValueExtractor1;

    private final ColumnValueExtractor columnValueExtractor2;

    private final ColumnValueExtractor columnValueExtractor3;

    private final ColumnValueExtractor columnValueExtractor4;

    private final ColumnValueExtractor columnValueExtractor5;

    private final ColumnValueExtractor columnValueExtractor6;

    private final ColumnValueExtractor columnValueExtractor7;

    private final ColumnValueExtractor columnValueExtractor8;

    private final int value1Offset;

    private final int value2Offset;

    private final int value3Offset;

    private final int value4Offset;

    private final int value5Offset;

    private final int value6Offset;

    private final int value7Offset;

    private final int value8Offset;

    public FixedWidthHashTableValuesAppender9Channels(FixedWidthEntryStructure structure)
    {
        requireNonNull(structure, "structure is null");
        checkArgument(structure.getHashChannelsCount() == 9);
        columnValueExtractor0 = structure.getColumnValueExtractors()[0];
        columnValueExtractor1 = structure.getColumnValueExtractors()[1];
        columnValueExtractor2 = structure.getColumnValueExtractors()[2];
        columnValueExtractor3 = structure.getColumnValueExtractors()[3];
        columnValueExtractor4 = structure.getColumnValueExtractors()[4];
        columnValueExtractor5 = structure.getColumnValueExtractors()[5];
        columnValueExtractor6 = structure.getColumnValueExtractors()[6];
        columnValueExtractor7 = structure.getColumnValueExtractors()[7];
        columnValueExtractor8 = structure.getColumnValueExtractors()[8];
        value1Offset = structure.getValuesOffsets()[1];
        value2Offset = structure.getValuesOffsets()[2];
        value3Offset = structure.getValuesOffsets()[3];
        value4Offset = structure.getValuesOffsets()[4];
        value5Offset = structure.getValuesOffsets()[5];
        value6Offset = structure.getValuesOffsets()[6];
        value7Offset = structure.getValuesOffsets()[7];
        value8Offset = structure.getValuesOffsets()[8];
    }

    @Override
    protected void appendValuesTo(HashTableData data, int batchSize, int[] groupIdBatch,
            int[] positionsBatch, int[] valuesOffsetBatch, boolean[] isNullBatch,
            PageBuilder pageBuilder, int outputChannelOffset, boolean outputHash)
    {
        FixedWidthGroupByHashTableEntries entries = (FixedWidthGroupByHashTableEntries) data.entries();
        for (int i = 0; i < batchSize; i++) {
            positionsBatch[i] = data.getPosition(groupIdBatch[i]);
        }
        for (int i = 0; i < batchSize; i++) {
            valuesOffsetBatch[i] = entries.getValuesOffset(positionsBatch[i]);
        }
        FastByteBuffer buffer = entries.getBuffer();
        appendValue0(pageBuilder, outputChannelOffset, entries, batchSize, positionsBatch, valuesOffsetBatch, isNullBatch, buffer);
        appendValue1(pageBuilder, outputChannelOffset, entries, batchSize, positionsBatch, valuesOffsetBatch, isNullBatch, buffer);
        appendValue2(pageBuilder, outputChannelOffset, entries, batchSize, positionsBatch, valuesOffsetBatch, isNullBatch, buffer);
        appendValue3(pageBuilder, outputChannelOffset, entries, batchSize, positionsBatch, valuesOffsetBatch, isNullBatch, buffer);
        appendValue4(pageBuilder, outputChannelOffset, entries, batchSize, positionsBatch, valuesOffsetBatch, isNullBatch, buffer);
        appendValue5(pageBuilder, outputChannelOffset, entries, batchSize, positionsBatch, valuesOffsetBatch, isNullBatch, buffer);
        appendValue6(pageBuilder, outputChannelOffset, entries, batchSize, positionsBatch, valuesOffsetBatch, isNullBatch, buffer);
        appendValue7(pageBuilder, outputChannelOffset, entries, batchSize, positionsBatch, valuesOffsetBatch, isNullBatch, buffer);
        appendValue8(pageBuilder, outputChannelOffset, entries, batchSize, positionsBatch, valuesOffsetBatch, isNullBatch, buffer);
        if (outputHash) {
            BlockBuilder hashBlockBuilder = pageBuilder.getBlockBuilder(outputChannelOffset + 9);
            for (int i = 0; i < batchSize; i++) {
                BIGINT.writeLong(hashBlockBuilder, entries.getHash(positionsBatch[i]));
            }
        }
    }

    private void appendValue0(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int batchSize, int[] positionsBatch,
            int[] valuesOffsetBatch, boolean[] isNullBatch, FastByteBuffer buffer)
    {
        for (int i = 0; i < batchSize; i++) {
            isNullBatch[i] = entries.isNull(positionsBatch[i], 0) == 1;
        }
        BlockBuilder blockBuilder0 = pageBuilder.getBlockBuilder(outputChannelOffset);
        for (int i = 0; i < batchSize; i++) {
            if (isNullBatch[i]) {
                blockBuilder0.appendNull();
            }
            else {
                columnValueExtractor0.appendValue(buffer, valuesOffsetBatch[i], blockBuilder0);
            }
        }
    }

    private void appendValue1(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int batchSize, int[] positionsBatch,
            int[] valuesOffsetBatch, boolean[] isNullBatch, FastByteBuffer buffer)
    {
        for (int i = 0; i < batchSize; i++) {
            isNullBatch[i] = entries.isNull(positionsBatch[i], 1) == 1;
        }
        BlockBuilder blockBuilder1 = pageBuilder.getBlockBuilder(outputChannelOffset + 1);
        for (int i = 0; i < batchSize; i++) {
            if (isNullBatch[i]) {
                blockBuilder1.appendNull();
            }
            else {
                columnValueExtractor1.appendValue(buffer, valuesOffsetBatch[i] + value1Offset, blockBuilder1);
            }
        }
    }

    private void appendValue2(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int batchSize, int[] positionsBatch,
            int[] valuesOffsetBatch, boolean[] isNullBatch, FastByteBuffer buffer)
    {
        for (int i = 0; i < batchSize; i++) {
            isNullBatch[i] = entries.isNull(positionsBatch[i], 2) == 1;
        }
        BlockBuilder blockBuilder2 = pageBuilder.getBlockBuilder(outputChannelOffset + 2);
        for (int i = 0; i < batchSize; i++) {
            if (isNullBatch[i]) {
                blockBuilder2.appendNull();
            }
            else {
                columnValueExtractor2.appendValue(buffer, valuesOffsetBatch[i] + value2Offset, blockBuilder2);
            }
        }
    }

    private void appendValue3(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int batchSize, int[] positionsBatch,
            int[] valuesOffsetBatch, boolean[] isNullBatch, FastByteBuffer buffer)
    {
        for (int i = 0; i < batchSize; i++) {
            isNullBatch[i] = entries.isNull(positionsBatch[i], 3) == 1;
        }
        BlockBuilder blockBuilder3 = pageBuilder.getBlockBuilder(outputChannelOffset + 3);
        for (int i = 0; i < batchSize; i++) {
            if (isNullBatch[i]) {
                blockBuilder3.appendNull();
            }
            else {
                columnValueExtractor3.appendValue(buffer, valuesOffsetBatch[i] + value3Offset, blockBuilder3);
            }
        }
    }

    private void appendValue4(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int batchSize, int[] positionsBatch,
            int[] valuesOffsetBatch, boolean[] isNullBatch, FastByteBuffer buffer)
    {
        for (int i = 0; i < batchSize; i++) {
            isNullBatch[i] = entries.isNull(positionsBatch[i], 4) == 1;
        }
        BlockBuilder blockBuilder4 = pageBuilder.getBlockBuilder(outputChannelOffset + 4);
        for (int i = 0; i < batchSize; i++) {
            if (isNullBatch[i]) {
                blockBuilder4.appendNull();
            }
            else {
                columnValueExtractor4.appendValue(buffer, valuesOffsetBatch[i] + value4Offset, blockBuilder4);
            }
        }
    }

    private void appendValue5(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int batchSize, int[] positionsBatch,
            int[] valuesOffsetBatch, boolean[] isNullBatch, FastByteBuffer buffer)
    {
        for (int i = 0; i < batchSize; i++) {
            isNullBatch[i] = entries.isNull(positionsBatch[i], 5) == 1;
        }
        BlockBuilder blockBuilder5 = pageBuilder.getBlockBuilder(outputChannelOffset + 5);
        for (int i = 0; i < batchSize; i++) {
            if (isNullBatch[i]) {
                blockBuilder5.appendNull();
            }
            else {
                columnValueExtractor5.appendValue(buffer, valuesOffsetBatch[i] + value5Offset, blockBuilder5);
            }
        }
    }

    private void appendValue6(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int batchSize, int[] positionsBatch,
            int[] valuesOffsetBatch, boolean[] isNullBatch, FastByteBuffer buffer)
    {
        for (int i = 0; i < batchSize; i++) {
            isNullBatch[i] = entries.isNull(positionsBatch[i], 6) == 1;
        }
        BlockBuilder blockBuilder6 = pageBuilder.getBlockBuilder(outputChannelOffset + 6);
        for (int i = 0; i < batchSize; i++) {
            if (isNullBatch[i]) {
                blockBuilder6.appendNull();
            }
            else {
                columnValueExtractor6.appendValue(buffer, valuesOffsetBatch[i] + value6Offset, blockBuilder6);
            }
        }
    }

    private void appendValue7(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int batchSize, int[] positionsBatch,
            int[] valuesOffsetBatch, boolean[] isNullBatch, FastByteBuffer buffer)
    {
        for (int i = 0; i < batchSize; i++) {
            isNullBatch[i] = entries.isNull(positionsBatch[i], 7) == 1;
        }
        BlockBuilder blockBuilder7 = pageBuilder.getBlockBuilder(outputChannelOffset + 7);
        for (int i = 0; i < batchSize; i++) {
            if (isNullBatch[i]) {
                blockBuilder7.appendNull();
            }
            else {
                columnValueExtractor7.appendValue(buffer, valuesOffsetBatch[i] + value7Offset, blockBuilder7);
            }
        }
    }

    private void appendValue8(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int batchSize, int[] positionsBatch,
            int[] valuesOffsetBatch, boolean[] isNullBatch, FastByteBuffer buffer)
    {
        for (int i = 0; i < batchSize; i++) {
            isNullBatch[i] = entries.isNull(positionsBatch[i], 8) == 1;
        }
        BlockBuilder blockBuilder8 = pageBuilder.getBlockBuilder(outputChannelOffset + 8);
        for (int i = 0; i < batchSize; i++) {
            if (isNullBatch[i]) {
                blockBuilder8.appendNull();
            }
            else {
                columnValueExtractor8.appendValue(buffer, valuesOffsetBatch[i] + value8Offset, blockBuilder8);
            }
        }
    }

    @Override
    public void appendValuesTo(HashTableData data, int groupId, PageBuilder pageBuilder,
            int outputChannelOffset, boolean outputHash)
    {
        FixedWidthGroupByHashTableEntries entries = (FixedWidthGroupByHashTableEntries) data.entries();
        int position = data.getPosition(groupId);
        FastByteBuffer buffer = entries.getBuffer();
        int valuesOffset = entries.getValuesOffset(position);
        appendValue0(pageBuilder, outputChannelOffset, entries, position, valuesOffset, buffer);
        appendValue1(pageBuilder, outputChannelOffset, entries, position, valuesOffset, buffer);
        appendValue2(pageBuilder, outputChannelOffset, entries, position, valuesOffset, buffer);
        appendValue3(pageBuilder, outputChannelOffset, entries, position, valuesOffset, buffer);
        appendValue4(pageBuilder, outputChannelOffset, entries, position, valuesOffset, buffer);
        appendValue5(pageBuilder, outputChannelOffset, entries, position, valuesOffset, buffer);
        appendValue6(pageBuilder, outputChannelOffset, entries, position, valuesOffset, buffer);
        appendValue7(pageBuilder, outputChannelOffset, entries, position, valuesOffset, buffer);
        appendValue8(pageBuilder, outputChannelOffset, entries, position, valuesOffset, buffer);
        if (outputHash) {
            BlockBuilder hashBlockBuilder = pageBuilder.getBlockBuilder(outputChannelOffset + 9);
            BIGINT.writeLong(hashBlockBuilder, entries.getHash(position));
        }
    }

    private void appendValue0(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int position, int valuesOffset,
            FastByteBuffer buffer)
    {
        BlockBuilder blockBuilder0 = pageBuilder.getBlockBuilder(outputChannelOffset);
        if (entries.isNull(position, 0) == 1) {
            blockBuilder0.appendNull();
        }
        else {
            columnValueExtractor0.appendValue(buffer, valuesOffset, blockBuilder0);
        }
    }

    private void appendValue1(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int position, int valuesOffset,
            FastByteBuffer buffer)
    {
        BlockBuilder blockBuilder1 = pageBuilder.getBlockBuilder(outputChannelOffset + 1);
        if (entries.isNull(position, 1) == 1) {
            blockBuilder1.appendNull();
        }
        else {
            columnValueExtractor1.appendValue(buffer, valuesOffset + value1Offset, blockBuilder1);
        }
    }

    private void appendValue2(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int position, int valuesOffset,
            FastByteBuffer buffer)
    {
        BlockBuilder blockBuilder2 = pageBuilder.getBlockBuilder(outputChannelOffset + 2);
        if (entries.isNull(position, 2) == 1) {
            blockBuilder2.appendNull();
        }
        else {
            columnValueExtractor2.appendValue(buffer, valuesOffset + value2Offset, blockBuilder2);
        }
    }

    private void appendValue3(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int position, int valuesOffset,
            FastByteBuffer buffer)
    {
        BlockBuilder blockBuilder3 = pageBuilder.getBlockBuilder(outputChannelOffset + 3);
        if (entries.isNull(position, 3) == 1) {
            blockBuilder3.appendNull();
        }
        else {
            columnValueExtractor3.appendValue(buffer, valuesOffset + value3Offset, blockBuilder3);
        }
    }

    private void appendValue4(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int position, int valuesOffset,
            FastByteBuffer buffer)
    {
        BlockBuilder blockBuilder4 = pageBuilder.getBlockBuilder(outputChannelOffset + 4);
        if (entries.isNull(position, 4) == 1) {
            blockBuilder4.appendNull();
        }
        else {
            columnValueExtractor4.appendValue(buffer, valuesOffset + value4Offset, blockBuilder4);
        }
    }

    private void appendValue5(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int position, int valuesOffset,
            FastByteBuffer buffer)
    {
        BlockBuilder blockBuilder5 = pageBuilder.getBlockBuilder(outputChannelOffset + 5);
        if (entries.isNull(position, 5) == 1) {
            blockBuilder5.appendNull();
        }
        else {
            columnValueExtractor5.appendValue(buffer, valuesOffset + value5Offset, blockBuilder5);
        }
    }

    private void appendValue6(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int position, int valuesOffset,
            FastByteBuffer buffer)
    {
        BlockBuilder blockBuilder6 = pageBuilder.getBlockBuilder(outputChannelOffset + 6);
        if (entries.isNull(position, 6) == 1) {
            blockBuilder6.appendNull();
        }
        else {
            columnValueExtractor6.appendValue(buffer, valuesOffset + value6Offset, blockBuilder6);
        }
    }

    private void appendValue7(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int position, int valuesOffset,
            FastByteBuffer buffer)
    {
        BlockBuilder blockBuilder7 = pageBuilder.getBlockBuilder(outputChannelOffset + 7);
        if (entries.isNull(position, 7) == 1) {
            blockBuilder7.appendNull();
        }
        else {
            columnValueExtractor7.appendValue(buffer, valuesOffset + value7Offset, blockBuilder7);
        }
    }

    private void appendValue8(PageBuilder pageBuilder, int outputChannelOffset,
            FixedWidthGroupByHashTableEntries entries, int position, int valuesOffset,
            FastByteBuffer buffer)
    {
        BlockBuilder blockBuilder8 = pageBuilder.getBlockBuilder(outputChannelOffset + 8);
        if (entries.isNull(position, 8) == 1) {
            blockBuilder8.appendNull();
        }
        else {
            columnValueExtractor8.appendValue(buffer, valuesOffset + value8Offset, blockBuilder8);
        }
    }
}
